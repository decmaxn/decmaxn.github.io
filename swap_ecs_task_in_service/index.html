<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Swap_ecs_task_in_service - Victor Ma</title><meta name=Description content="Victro Ma's blog"><meta property="og:title" content="Swap_ecs_task_in_service"><meta property="og:description" content="Start another ECS task for service before stop the original task I have made an improvement to my stop ecs task Lambda function that manages my ECS service in a more graceful manner. Previously, it would stop the task associated with my ECS service to trigger a service refresh. This would result in the service being offline for a few minutes.
With this improvement, it now increases the task count to 2, effectively launching a new task."><meta property="og:type" content="article"><meta property="og:url" content="https://decmaxn.github.io/swap_ecs_task_in_service/"><meta property="og:image" content="https://decmaxn.github.io/logo.png"><meta property="article:published_time" content="2023-02-15T08:50:56-05:00"><meta property="article:modified_time" content="2023-02-19T17:34:01-05:00"><meta property="og:site_name" content="Victor Ma"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://decmaxn.github.io/logo.png"><meta name=twitter:title content="Swap_ecs_task_in_service"><meta name=twitter:description content="Start another ECS task for service before stop the original task I have made an improvement to my stop ecs task Lambda function that manages my ECS service in a more graceful manner. Previously, it would stop the task associated with my ECS service to trigger a service refresh. This would result in the service being offline for a few minutes.
With this improvement, it now increases the task count to 2, effectively launching a new task."><meta name=application-name content="Victor Ma"><meta name=apple-mobile-web-app-title content="Victor Ma"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://decmaxn.github.io/swap_ecs_task_in_service/><link rel=prev href=https://decmaxn.github.io/stop_ecs_task/><link rel=next href=https://decmaxn.github.io/git_under_the_hood/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Swap_ecs_task_in_service","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/decmaxn.github.io\/swap_ecs_task_in_service\/"},"image":["https:\/\/decmaxn.github.io\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"coding, python, boto3","wordcount":642,"url":"https:\/\/decmaxn.github.io\/swap_ecs_task_in_service\/","datePublished":"2023-02-15T08:50:56-05:00","dateModified":"2023-02-19T17:34:01-05:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/decmaxn.github.io\/images\/avatar.png"},"author":{"@type":"Person","name":"Victor Ma"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Victor Ma">Victor Ma</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/python/>Python </a><a class=menu-item href=/git/>Git </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/decmaxn title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw" aria-hidden=true></i></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Victor Ma">Victor Ma</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/python/>Python</a><a class=menu-item href=/git/>Git</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/about/>About</a><a class=menu-item href=https://github.com/decmaxn title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Swap_ecs_task_in_service</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Victor Ma</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-02-15>2023-02-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;642 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;<span id=/swap_ecs_task_in_service/ class=leancloud_visitors data-flag-title=Swap_ecs_task_in_service>
<i class="far fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><h1 id=start-another-ecs-task-for-service-before-stop-the-original-task>Start another ECS task for service before stop the original task</h1><p>I have made an improvement to my <a href=../stop_ecs_task rel>stop ecs task </a>Lambda function that manages my ECS service in a more graceful manner. Previously, it would stop the task associated with my ECS service to trigger a service refresh. This would result in the service being offline for a few minutes.</p><p>With this improvement, it now increases the task count to 2, effectively launching a new task. This new task runs in parallel with the existing task, ensuring that there is no downtime for my ECS service. Once the new task is confirmed as stable, it then proceeds to stop the old task.</p><p>By doing this, my ECS service remains available throughout the entire update process, as the new task is already running and handling requests before the old task is stopped. This ensures a smooth and uninterrupted user experience, as my service is always available.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>boto3</span> 
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=c1># The handler function is triggered when the AWS Lambda function is executed.</span>
<span class=k>def</span> <span class=nf>handler</span><span class=p>(</span><span class=n>event</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
    <span class=c1># This app change desired number to 2 and wait for it stable, then change it back after kill old runing tasks</span>

    <span class=c1># The boto3 library is imported and the &#39;ecs&#39; client is created using boto3.client().</span>
    <span class=n>client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;ecs&#39;</span><span class=p>)</span>
    
    <span class=c1># The cluster_name and service_name are read from environment variables &#39;CLUSTER_NAME&#39; and &#39;SERVICE_NAME&#39;.</span>
    <span class=n>cluster_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;CLUSTER_NAME&#39;</span><span class=p>]</span>
    <span class=n>service_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s1>&#39;SERVICE_NAME&#39;</span><span class=p>]</span>
    <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Cluster name: {cluster_name}&#34;</span><span class=p>)</span>
    <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Service name: {service_name}&#34;</span><span class=p>)</span>

    <span class=c1># A helper function &#34;stoptask&#34; is defined that takes in a task ID and a reason for stopping the task.</span>
    <span class=k>def</span> <span class=nf>stoptask</span><span class=p>(</span><span class=n>task_id</span><span class=p>,</span> <span class=n>reason</span><span class=p>):</span>
        <span class=c1># This function stops the task by calling the &#39;stop_task&#39; method of the ECS client, passing the cluster_name, task ID, and reason for stopping the task.</span>
        <span class=n>resp</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>stop_task</span><span class=p>(</span>
            <span class=n>cluster</span><span class=o>=</span><span class=n>cluster_name</span><span class=p>,</span>
            <span class=n>task</span><span class=o>=</span><span class=n>task_id</span><span class=p>,</span>
            <span class=n>reason</span><span class=o>=</span> <span class=s2>&#34;Daily refresh&#34;</span> 
            <span class=p>)</span>
        <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Task ID: {task_id}&#34;</span><span class=p>)</span>
        <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Response from stop_task: {resp}&#34;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>resp</span>

    <span class=c1># A helper function to use &#39;list_tasks&#39; method of the ECS client is called to retrieve a list of all running tasks for the specified service in the cluster.</span>
    <span class=k>def</span> <span class=nf>listtasks</span><span class=p>():</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>list_tasks</span><span class=p>(</span>
            <span class=n>cluster</span><span class=o>=</span><span class=n>cluster_name</span><span class=p>,</span>
            <span class=n>desiredStatus</span><span class=o>=</span><span class=s1>&#39;RUNNING&#39;</span><span class=p>,</span>
            <span class=n>serviceName</span><span class=o>=</span><span class=n>service_name</span><span class=p>,</span>
            <span class=n>launchType</span><span class=o>=</span><span class=s1>&#39;FARGATE&#39;</span>
        <span class=p>)</span>
        <span class=n>tasks</span> <span class=o>=</span> <span class=n>response</span><span class=p>[</span><span class=s2>&#34;taskArns&#34;</span><span class=p>]</span>
        <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Running tasks: {tasks}&#34;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>tasks</span>

    <span class=c1># A helper function to change the desired number </span>
    <span class=k>def</span> <span class=nf>desiredcount</span><span class=p>(</span><span class=n>new_desired_count</span><span class=p>):</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>update_service</span><span class=p>(</span>
            <span class=n>cluster</span><span class=o>=</span><span class=n>cluster_name</span><span class=p>,</span>
            <span class=n>service</span><span class=o>=</span><span class=n>service_name</span><span class=p>,</span>
            <span class=n>desiredCount</span><span class=o>=</span><span class=n>new_desired_count</span>
        <span class=p>)</span>
        <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Updated Service {service_name} to have {new_desired_count} desired numbers&#34;</span><span class=p>)</span>

    <span class=c1># A helper function to Wait for service to be stable</span>
    <span class=k>def</span> <span class=nf>wait_service_stable</span><span class=p>():</span>
        <span class=n>max_attempts</span> <span class=o>=</span> <span class=mi>36</span> <span class=c1># set a maximum number of attempts to prevent an infinite loop</span>
        <span class=n>attempts</span> <span class=o>=</span> <span class=mi>0</span>
        <span class=k>while</span> <span class=bp>True</span><span class=p>:</span>
            <span class=n>describe_response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>describe_services</span><span class=p>(</span>
                <span class=n>cluster</span><span class=o>=</span><span class=n>cluster_name</span><span class=p>,</span>
                <span class=n>services</span><span class=o>=</span><span class=p>[</span><span class=n>service_name</span><span class=p>]</span>
            <span class=p>)</span>
            <span class=n>service</span> <span class=o>=</span> <span class=n>describe_response</span><span class=p>[</span><span class=s1>&#39;services&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
            <span class=n>running_count</span> <span class=o>=</span> <span class=n>service</span><span class=p>[</span><span class=s1>&#39;runningCount&#39;</span><span class=p>]</span>
            <span class=n>desired_count</span> <span class=o>=</span> <span class=n>service</span><span class=p>[</span><span class=s1>&#39;desiredCount&#39;</span><span class=p>]</span>
            <span class=c1># print(f&#34;Running tasks: {running_count}/{desired_count}&#34;)</span>
            <span class=k>if</span> <span class=n>running_count</span> <span class=o>==</span> <span class=n>desired_count</span><span class=p>:</span>
                <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Service {service_name} now has {running_count} running tasks&#34;</span><span class=p>)</span>
                <span class=k>break</span>
            <span class=n>attempts</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=k>if</span> <span class=n>attempts</span> <span class=o>&gt;=</span> <span class=n>max_attempts</span><span class=p>:</span>
                <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Service {service_name} did not become stable within {max_attempts} attempts&#34;</span><span class=p>)</span>
                <span class=k>break</span>
            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>

    <span class=c1># Increase desired number to 2 and wait for it become stable</span>
    <span class=n>tasks</span> <span class=o>=</span> <span class=n>listtasks</span><span class=p>()</span> 
    <span class=n>desiredcount</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
    <span class=n>wait_service_stable</span><span class=p>()</span>

    <span class=c1># A for loop iterates over the task IDs and calls the stoptask function, passing in the task ID and a reason for stopping the task. The response from the stoptask function is printed.</span>
    <span class=k>for</span> <span class=n>task</span> <span class=ow>in</span> <span class=n>tasks</span><span class=p>:</span>
        <span class=n>stoptask</span><span class=p>(</span><span class=n>task</span><span class=p>,</span><span class=s2>&#34;Daily refresh&#34;</span><span class=p>)</span>
        <span class=k>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&#34;Stopped the originally running task {task}&#34;</span><span class=p>)</span>

    <span class=c1># Decrease desired number back to 1 and wait for it become stable</span>
    <span class=n>desiredcount</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>wait_service_stable</span><span class=p>()</span>
    <span class=n>listtasks</span><span class=p>()</span>
</code></pre></td></tr></table></div></div><p>functions stoptask, listtasks, desiredcount and wait_service_stable have all been used more than once.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-02-19&nbsp;<a class=git-hash href=https://github.com/decmaxn/commit/15a8a9954f01ce87fefc9c12f0d5d6b910e58695 target=_blank title="commit by Victor Ma(victor.ma@gmail.com) 15a8a9954f01ce87fefc9c12f0d5d6b910e58695: reorgnize blogs between python and post">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>15a8a99</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/swap_ecs_task_in_service/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://decmaxn.github.io/swap_ecs_task_in_service/ data-title=Swap_ecs_task_in_service data-via=decmaxn data-hashtags=coding,python,boto3><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://decmaxn.github.io/swap_ecs_task_in_service/ data-hashtag=coding><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://decmaxn.github.io/swap_ecs_task_in_service/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://decmaxn.github.io/swap_ecs_task_in_service/ data-title=Swap_ecs_task_in_service data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://decmaxn.github.io/swap_ecs_task_in_service/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://decmaxn.github.io/swap_ecs_task_in_service/ data-title=Swap_ecs_task_in_service><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/coding/>coding</a>,&nbsp;<a href=/tags/python/>python</a>,&nbsp;<a href=/tags/boto3/>boto3</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/stop_ecs_task/ class=prev rel=prev title=Stop_ecs_task><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Stop_ecs_task</a>
<a href=/git_under_the_hood/ class=next rel=next title=git_under_the_hood>git_under_the_hood<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.68.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i>LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2012 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Victor Ma</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/valine@1.5.0/dist/Valine.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"valine":{"appId":"QGzwQXOqs5JOhN4RGPOkR2mR-MdYXbMMI","appKey":"WBmoGyJtbqUswvfLh6L8iEBr","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"serverURLs":"https://leancloud.hugoloveit.com","visitor":true}},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>