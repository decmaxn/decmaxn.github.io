<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Practice Go with S3 buckets - Victor Ma</title><meta name=Description content="Victro Ma's blog"><meta property="og:title" content="Practice Go with S3 buckets"><meta property="og:description" content="Practice Go deleting s3 buckets Create an test env
1 2  go mod init test # this will create a go.mod file go get github.com/aws/aws-sdk-go # this will add 2 requirements in go.mod file   Here is the main.go file to learn from:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132  package main import ( &#34;bufio&#34; &#34;fmt&#34; &#34;os&#34; &#34;strings&#34; &#34;github."><meta property="og:type" content="article"><meta property="og:url" content="https://decmaxn.github.io/go/practice-go-with-s3/"><meta property="og:image" content="https://decmaxn.github.io/logo.png"><meta property="article:published_time" content="2023-04-19T13:24:06-04:00"><meta property="article:modified_time" content="2023-05-15T22:06:04-04:00"><meta property="og:site_name" content="Victor Ma"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://decmaxn.github.io/logo.png"><meta name=twitter:title content="Practice Go with S3 buckets"><meta name=twitter:description content="Practice Go deleting s3 buckets Create an test env
1 2  go mod init test # this will create a go.mod file go get github.com/aws/aws-sdk-go # this will add 2 requirements in go.mod file   Here is the main.go file to learn from:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132  package main import ( &#34;bufio&#34; &#34;fmt&#34; &#34;os&#34; &#34;strings&#34; &#34;github."><meta name=application-name content="Victor Ma"><meta name=apple-mobile-web-app-title content="Victor Ma"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://decmaxn.github.io/go/practice-go-with-s3/><link rel=prev href=https://decmaxn.github.io/go/simple-web-server-1/><link rel=next href=https://decmaxn.github.io/go/anonymous-function/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Practice Go with S3 buckets","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/decmaxn.github.io\/go\/practice-go-with-s3\/"},"image":["https:\/\/decmaxn.github.io\/images\/Apple-Devices-Preview.png"],"genre":"Go","keywords":"coding, Go, tips","wordcount":493,"url":"https:\/\/decmaxn.github.io\/go\/practice-go-with-s3\/","datePublished":"2023-04-19T13:24:06-04:00","dateModified":"2023-05-15T22:06:04-04:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"https:\/\/decmaxn.github.io\/images\/avatar.png"},"author":{"@type":"Person","name":"Victor Ma"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Victor Ma">Victor Ma</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/python/>Python </a><a class=menu-item href=/go/>Go </a><a class=menu-item href=/k8s/>K8s </a><a class=menu-item href=/aws/>Aws </a><a class=menu-item href=/azure/>Azure </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/decmaxn title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw" aria-hidden=true></i></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Victor Ma">Victor Ma</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/python/>Python</a><a class=menu-item href=/go/>Go</a><a class=menu-item href=/k8s/>K8s</a><a class=menu-item href=/aws/>Aws</a><a class=menu-item href=/azure/>Azure</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/about/>About</a><a class=menu-item href=https://github.com/decmaxn title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Practice Go with S3 buckets</h1><div class=content id=content><h2 id=practice-go-deleting-s3-buckets>Practice Go deleting s3 buckets</h2><p>Create an test env</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>go mod init <span class=nb>test</span>  <span class=c1># this will create a go.mod file</span>
go get github.com/aws/aws-sdk-go <span class=c1># this will add 2 requirements in go.mod file</span>
</code></pre></td></tr></table></div></div><p>Here is the main.go file to learn from:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
	<span class=s>&#34;bufio&#34;</span>
	<span class=s>&#34;fmt&#34;</span>
	<span class=s>&#34;os&#34;</span>
	<span class=s>&#34;strings&#34;</span>

	<span class=s>&#34;github.com/aws/aws-sdk-go/aws&#34;</span>
	<span class=s>&#34;github.com/aws/aws-sdk-go/aws/session&#34;</span>
	<span class=s>&#34;github.com/aws/aws-sdk-go/service/s3&#34;</span>
<span class=p>)</span>

<span class=c1>// 声明getBucketRegion函数，main 调用来得到某个 s3 bucket的region 
</span><span class=c1>// 接受一个 svc 参数，类型为 *s3.S3，和一个 bucketName 参数，类型为 *string。
</span><span class=c1></span><span class=kd>func</span> <span class=nf>getBucketRegion</span><span class=p>(</span><span class=nx>svc</span> <span class=o>*</span><span class=nx>s3</span><span class=p>.</span><span class=nx>S3</span><span class=p>,</span> <span class=nx>bucketName</span> <span class=o>*</span><span class=kt>string</span><span class=p>)</span> <span class=p>(</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
	<span class=c1>//s3.GetBucketLocationInput 是一个结构体类型, 用&amp;对结构体进行取址操作
</span><span class=c1></span>	<span class=nx>input</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>s3</span><span class=p>.</span><span class=nx>GetBucketLocationInput</span><span class=p>{</span>
		<span class=nx>Bucket</span><span class=p>:</span> <span class=nx>bucketName</span><span class=p>,</span>
	<span class=p>}</span>

	<span class=c1>//svc 是一个 *s3.S3 类型的指针，表示 AWS S3 服务的客户端。
</span><span class=c1></span>	<span class=c1>// 使用 := 运算符对返回的结果进行声明和赋值。
</span><span class=c1></span>	<span class=nx>result</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>svc</span><span class=p>.</span><span class=nf>GetBucketLocation</span><span class=p>(</span><span class=nx>input</span><span class=p>)</span>
	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
		<span class=k>return</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>err</span>
	<span class=p>}</span>

	<span class=c1>// 解析存储桶的区域
</span><span class=c1></span>	<span class=nx>region</span> <span class=o>:=</span> <span class=s>&#34;&#34;</span>
	<span class=c1>// 判断 result.LocationConstraint 是否为 nil。
</span><span class=c1></span>	<span class=k>if</span> <span class=nx>result</span><span class=p>.</span><span class=nx>LocationConstraint</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
		<span class=c1>//如果 result.LocationConstraint 是一个空字符串
</span><span class=c1></span>		<span class=k>if</span> <span class=o>*</span><span class=nx>result</span><span class=p>.</span><span class=nx>LocationConstraint</span> <span class=o>==</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
			<span class=nx>region</span> <span class=p>=</span> <span class=s>&#34;us-east-1&#34;</span> <span class=c1>// 则存储桶在US East
</span><span class=c1></span>		<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
			<span class=nx>region</span> <span class=p>=</span> <span class=o>*</span><span class=nx>result</span><span class=p>.</span><span class=nx>LocationConstraint</span>
		<span class=p>}</span>
	<span class=p>}</span>

	<span class=k>return</span> <span class=nx>region</span><span class=p>,</span> <span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=c1>// 创建一个新的AWS会话
</span><span class=c1></span>	<span class=nx>sess</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>session</span><span class=p>.</span><span class=nf>NewSession</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>aws</span><span class=p>.</span><span class=nx>Config</span><span class=p>{</span>
		<span class=nx>Region</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;us-west-2&#34;</span><span class=p>),</span> 
	<span class=p>})</span>
	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;无法创建AWS会话:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
		<span class=k>return</span>
	<span class=p>}</span>

	<span class=c1>// 创建S3服务客户端
</span><span class=c1></span>	<span class=nx>svc</span> <span class=o>:=</span> <span class=nx>s3</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>sess</span><span class=p>)</span>

	<span class=c1>// 读取用户输入的模式
</span><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;请输入要匹配的模式：&#34;</span><span class=p>)</span>
	<span class=nx>scanner</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewScanner</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
	<span class=nx>scanner</span><span class=p>.</span><span class=nf>Scan</span><span class=p>()</span>
	<span class=nx>pattern</span> <span class=o>:=</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Text</span><span class=p>()</span>

	<span class=c1>// 列出存储桶
</span><span class=c1></span>	<span class=nx>result</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>svc</span><span class=p>.</span><span class=nf>ListBuckets</span><span class=p>(</span><span class=kc>nil</span><span class=p>)</span>
	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;无法列出存储桶:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
		<span class=k>return</span>
	<span class=p>}</span>

	<span class=c1>//创建一个空(最后的0的意义）的切片 matchedBuckets，
</span><span class=c1></span>	<span class=c1>//其元素类型为 *s3.Bucket。
</span><span class=c1></span>	<span class=c1>//make 函数用于创建一个指定类型、指定长度和容量的切片.
</span><span class=c1></span>	<span class=nx>matchedBuckets</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=o>*</span><span class=nx>s3</span><span class=p>.</span><span class=nx>Bucket</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>bucket</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>result</span><span class=p>.</span><span class=nx>Buckets</span> <span class=p>{</span>
		<span class=c1>//bucket.Name 是一个指向 *string 类型的指针，
</span><span class=c1></span>		<span class=c1>//通过调用 aws.StringValue 函数可以获取其指向的字符串值。
</span><span class=c1></span>		<span class=nx>bucketName</span> <span class=o>:=</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>StringValue</span><span class=p>(</span><span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>)</span>
		<span class=c1>//检查 bucketName 是否包含指定的 pattern 字符串
</span><span class=c1></span>		<span class=k>if</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Contains</span><span class=p>(</span><span class=nx>bucketName</span><span class=p>,</span> <span class=nx>pattern</span><span class=p>)</span> <span class=p>{</span>
			<span class=nx>matchedBuckets</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>matchedBuckets</span><span class=p>,</span> <span class=nx>bucket</span><span class=p>)</span>
		<span class=p>}</span>
	<span class=p>}</span>

	<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>matchedBuckets</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;没有找到匹配的存储桶&#34;</span><span class=p>)</span>
		<span class=k>return</span>
	<span class=p>}</span>

	<span class=c1>// 打印匹配的存储桶列表
</span><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;匹配的存储桶列表:&#34;</span><span class=p>)</span>
	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>bucket</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>matchedBuckets</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>aws</span><span class=p>.</span><span class=nf>StringValue</span><span class=p>(</span><span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>))</span>
	<span class=p>}</span>

	<span class=c1>// 确认删除存储桶
</span><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;是否确认删除这些存储桶？(yes/no): &#34;</span><span class=p>)</span>
	<span class=nx>scanner</span><span class=p>.</span><span class=nf>Scan</span><span class=p>()</span>
	<span class=nx>confirmation</span> <span class=o>:=</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Text</span><span class=p>()</span>

	<span class=k>if</span> <span class=nx>confirmation</span> <span class=o>==</span> <span class=s>&#34;yes&#34;</span> <span class=p>{</span>
		<span class=c1>// 删除存储桶
</span><span class=c1></span>		<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>bucket</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>matchedBuckets</span> <span class=p>{</span>
			<span class=nx>bucketRegion</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>getBucketRegion</span><span class=p>(</span><span class=nx>svc</span><span class=p>,</span> <span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>)</span>
			<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;无法获取存储桶 %s 的区域: %v\n&#34;</span><span class=p>,</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>StringValue</span><span class=p>(</span><span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>),</span> <span class=nx>err</span><span class=p>)</span>
				<span class=k>continue</span>
			<span class=p>}</span>

			<span class=c1>// TODO: investigate if virginia&#39;s bucket is like this
</span><span class=c1></span>			<span class=k>if</span> <span class=nx>bucketRegion</span> <span class=o>==</span> <span class=s>&#34;&#34;</span> <span class=p>{</span>
				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;无法确定存储桶 %s 的区域\n&#34;</span><span class=p>,</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>StringValue</span><span class=p>(</span><span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>))</span>
				<span class=k>continue</span>
			<span class=p>}</span>

			<span class=c1>// 为这个BUCKET创建一个新的AWS会话
</span><span class=c1></span>			<span class=nx>bucketSvc</span> <span class=o>:=</span> <span class=nx>s3</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>session</span><span class=p>.</span><span class=nf>Must</span><span class=p>(</span><span class=nx>session</span><span class=p>.</span><span class=nf>NewSession</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>aws</span><span class=p>.</span><span class=nx>Config</span><span class=p>{</span>
				<span class=nx>Region</span><span class=p>:</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=nx>bucketRegion</span><span class=p>),</span>
			<span class=p>})))</span>

			<span class=nx>_</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>bucketSvc</span><span class=p>.</span><span class=nf>DeleteBucket</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>s3</span><span class=p>.</span><span class=nx>DeleteBucketInput</span><span class=p>{</span>
				<span class=nx>Bucket</span><span class=p>:</span> <span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
			<span class=p>})</span>
			<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;无法删除存储桶 %s: %v\n&#34;</span><span class=p>,</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>StringValue</span><span class=p>(</span><span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>),</span> <span class=nx>err</span><span class=p>)</span>
			<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;已成功删除存储桶 %s\n&#34;</span><span class=p>,</span> <span class=nx>aws</span><span class=p>.</span><span class=nf>StringValue</span><span class=p>(</span><span class=nx>bucket</span><span class=p>.</span><span class=nx>Name</span><span class=p>))</span>
			<span class=p>}</span>
		<span class=p>}</span>
	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;已取消删除操作&#34;</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.68.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i>LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2012 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Victor Ma</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/valine@1.5.0/dist/Valine.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"valine":{"appId":"QGzwQXOqs5JOhN4RGPOkR2mR-MdYXbMMI","appKey":"WBmoGyJtbqUswvfLh6L8iEBr","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@14.0.0/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"serverURLs":"https://leancloud.hugoloveit.com","visitor":true}},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>